{
    "contents" : "---\ntitle: \"Does selection have any effect on structural divergence?\"\nauthor: \"Julian Echave\"\ndate: \"18 August 2015\"\noutput:\n  html_document:\n    theme: cerulean\n    toc: yes\n  pdf_document:\n    toc: yes\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(warning=FALSE)\n```\n\n\n\n\n```{r echo=FALSE,cache=TRUE}\n\n# Load libraries\nlibrary(ggplot2)\nlibrary(reshape2)\n\n# Define functions \nmyErrorBar= function(x) {\n    result = c(mean(x) - sd(x), mean(x) + sd(x))\n    names(result) = c(\"ymin\", \"ymax\")\n    result\n}\nmyMeanErrorBar= function(x) {\n    n = length(x)\n    result = c(mean(x) - 1.96*sd(x)/sqrt(n), mean(x) + 1.96*sd(x)/sqrt(n))\n    names(result) = c(\"ymin\", \"ymax\")\n    result\n}\n\nmyCI = function(x) {\n    alpha = 0.05\n    result = quantile(x,probs = c(alpha,1-alpha))\n    names(result) = c(\"ymin\", \"ymax\")\n    result\n}\n\n# Read data\ndfExperimental = read.csv(\"data/rho.auc.experimental.csv\")\ndfTheoretical = read.csv(\"data/rho.auc.teorico.csv\")\ndfExperimental$proteinType = \"experimental\"\ndfTheoretical$proteinType = \"theoretical\"\ndf = rbind(dfExperimental,dfTheoretical)\n\nnames(df)[1] = \"protein\"\n\n```\n# Motivation\n\nWe want to know whether the structural divergence, as analyzed in a normal-mode representation, \nhas any signature of natural selection. \nIf it did, the pattern of structural divergence along different normal modes observed for a set of actual homologous proteins (\"experimental\" set) should differ from that expected from \"theoretical\" mutants obtained using the LFENM model introducing random unselected mutations.\n\n\n# Results\nData are in a table with three columns:\n\n```{r}\nhead(df)\n```\n\nAre the individual values of rho and auc for the experimental dataset within what we would expect from the theoretical distribution?\nThe mean empirical rho is \n`r round(mean(df$rho[df$proteinType == \"experimental\"]),2)` $\\pm$\n`r round(sd(df$rho[df$proteinType == \"experimental\"])/sqrt(sum(df$proteinType==\"experimental\")),2)`, \nthe mean theoretical rho is  `r round(mean(df$rho[df$proteinType == \"theoretical\"]),2)` $\\pm$  `r round(sd(df$rho[df$proteinType == \"theoretical\"])/sqrt(sum(df$proteinType==\"theoretical\")),3)`.  \nSimilarly, the mean empirical AUC is \n`r round(mean(df$auc[df$proteinType == \"experimental\"]),2)` $\\pm$\n`r round(sd(df$auc[df$proteinType == \"experimental\"])/sqrt(sum(df$proteinType==\"experimental\")),2)`, \nthe mean theoretical AUC is  `r round(mean(df$auc[df$proteinType == \"theoretical\"]),2)` $\\pm$  `r round(sd(df$auc[df$proteinType ==\n\"theoretical\"])/sqrt(sum(df$proteinType==\"theoretical\")),3)`.  \nThus, both AUC and rho are lower, when averaged, than predicted using the LFENM.\n\nIt is instructive to look at the actual empirical values for each protein in relationship to the theoretical distribution:\n\n```{r}\n\nlibrary(ggplot2)\nlibrary(reshape2)\n\ndat = melt(df,id.vars = c(\"proteinType\",\"protein\"),measure.vars = c(\"auc\",\"rho\"))\ndatE = subset(dat,proteinType == \"experimental\")\ndatT = subset(dat,proteinType == \"theoretical\")\n\nggplot(datT,aes(x=value)) + geom_density() +\n    geom_point(data=datE,aes(x=value,y=0)) +\n    facet_grid(~variable)\n\n```\n\nClearly, all values are within the distribution predicted by the mutational LFENM. However, as we saw before, there's larger density of experimental points at smaller rho and auc valures.\nThe following plot shows the distributions of AUC and rho for the set of \"experimental\" proteins compared with that obtained using LFENM simulations.\n\n```{r}\n\nlibrary(reshape2)\nlibrary(ggplot2)\n\ndat = melt(df,id.vars = c(\"proteinType\",\"protein\"),measure.vars = c(\"auc\",\"rho\"))\n\nggplot(dat,aes(x=value,col=proteinType)) + geom_density() + facet_grid(~variable,scales=\"free\")\n\n```\n\nIt can be seen from these plots that:\n\n* The distributions of auc and rho seem to be to the left of the theoretical distribution. This is: AUC and rhow are smaller than they would be if the esperimental proteins were generated using the unselected LFENM model. \n\n* That AUC is smaller means that the lowest normal modes contribute less than expected to the empirical divergence. \n\n* That rho is smaller (more negative) is more difficult to interpret, but it would mean also that low-energy normal modes contribute less than expected from the mutational LFENM theoretical mutants.\n\n* We should also note that the theoretical distributiosn are asymmetric.\n\n* More importantly, the expected value of rho is not 0 for the theoretical distribution but, rather, less than 0. Why?\n\n* Is there evidence of natural selection? The fact that the theoretical rho distribution is centered at a rho value less han 0 suggests there may be other effects. If rho were calculated using Pn averaged over mutants, then it should be 0: it can be mathematically demonstrated that <Pn> should increase linearly with 1/lambda_n. This does not mean, of course, that it would be 0, or even centered around 0, for Pn for a given protein (i.e. calculating rho for individual proteins, then averaging, is not necessarily the same as averaging Pn first, then calculating rho).\n\n* Another effect may be a bias towards lower contribution of the highest normal modes due to the rotation of proteins to maximize their structural superposition. To see if there's such an effect, we need also the rho values (and auc values) for a set of theoretical proteins that are NOT rotated before calculating rho/auc.\n\n\n# Unresolved issues\n\nFrom this data, I think the following issues are not yet resolved:\n\n1. What is the effect of rotating structures to maximize superposition? In particular, isn't it possible that this will result in a seeming smaller contribution of the lowest normal modes, so that what we're observing is not natural selection but an artifact due to structure superposition?\n\n2. What is the effect of not being able to align all sites when a given site is too structurally diverged? i.e. in the alignment of actual proteins, if a site has diverged much, it will be impossible to align it, and it will not be included in the comparison. This is another possible reason why there may be an underestimation of the Pn of lowest normal modes.\n\n3. What is the effect of using the wrong model? For the theoretical case, the same model (e.g. the ANM) is used for both generating the mutants and analysing the results. In contrast, the \"experimental\" proteins are generated by a \"model\" that is a priori not identical with the model used to analyze the results (the \"true\" model, that we do not know). We could study this effect by generating the theoretical data with a model different from the one used to analyse it.\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1443633480706.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "198277045",
    "id" : "963FEE37",
    "lastKnownWriteTime" : 1442424392,
    "path" : "C:/Users/Laurita/Downloads/structuralDivergence (1).Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_markdown"
}